# Three.js 3D 扭蛋機抽獎專案任務清單

> **專案目標**：製作會動的 3D 扭蛋機，用於醫院春酒抽獎活動

## 在測試的時候要考量瀏覽器版本的問題

## 一、專案初始化

- [x] 初始化 Next.js 16 專案（App Router）
- [x] 安裝 TypeScript
- [x] 安裝 React Three Fiber 與 Drei
- [x] 安裝 Tailwind CSS 與 Shadcn UI
- [x] 安裝 Zustand 狀態管理
- [x] 建立 Git 倉庫與初始提交
- [x] 確認 Node.js 版本 >= 20

## 二、3D 扭蛋機場景建置

- [x] 建立 Scene.tsx 基礎場景
- [x] 加入 GLTF 扭蛋機模型（gacha.gltf）
- [x] 配置相機位置與 OrbitControls
- [x] 設置 HDR 環境照明（Environment）
- [x] 模型居中與縮放調整
- [ ] 識別扭蛋機可動部件（把手/旋鈕）
- [ ] 測試模型在不同設備上的載入效能

## 三、扭蛋機動畫系統

- [ ] 分析扭蛋機模型結構（找出把手、扭蛋出口等部件）
- [ ] 實作把手旋轉動畫（rotation animation）
- [ ] 建立扭蛋物件（球體或膠囊形狀）
- [ ] 實作扭蛋掉落動畫（從出口滾出）
- [ ] 實作扭蛋打開動畫（開蓋或爆開效果）
- [ ] 加入動畫緩動效果（easing）

## 四、狀態管理

- [ ] 設計 LotteryPhase 狀態機（idle / turning / dropping / opening / revealing / done）
- [ ] 使用 Zustand 建立 store（phase / winner / startDraw / resetDraw）
- [ ] 將扭蛋機動畫與 store 狀態連動
- [ ] 處理動畫序列的時間控制

## 五、抽獎流程與邏輯

- [ ] 點擊開始抽獎 → phase: turning（把手開始轉動）
- [ ] 呼叫 API 決定中獎者
- [ ] phase: dropping（扭蛋從出口掉落）
- [ ] phase: opening（扭蛋打開）
- [ ] phase: revealing（顯示中獎者資訊）
- [ ] 顯示中獎者姓名與部門（UI 彈窗或 3D 文字）
- [ ] phase 切換至 done

## 六、API 串接

- [ ] 設計 `/api/draw` 路由
- [ ] 回傳中獎者資料（id / name / department / avatar?）
- [ ] 前端抽獎流程整合 API
- [ ] 處理錯誤情況（API 失敗 / 重試 / 無人可抽）
- [ ] 實作防重複中獎邏輯（後端或前端）

## 七、UI / 控制面板

- [ ] 設計開始抽獎按鈕（固定在畫面上方或下方）
- [ ] 設計中獎者資訊顯示卡片
- [ ] 設計重播 / 下一輪按鈕
- [ ] 設計抽獎中 / 已完成狀態提示
- [ ] 行動裝置適配（RWD）
- [ ] 加入 Loading 提示（模型載入中）

## 八、音效與特效（選配）

- [ ] 加入扭蛋機音效（把手轉動、掉落、打開）
- [ ] 加入中獎音效與背景音樂
- [ ] 加入光影效果（聚光燈照在扭蛋上）
- [ ] 加入粒子效果（扭蛋打開時的彩帶或星星）
- [ ] 可選後製效果（Bloom / 光暈）

## 九、測試與部署

- [ ] 測試多瀏覽器兼容性（Chrome / Edge / Safari）
- [ ] 測試多設備兼容性（桌機 / 平板 / 手機）
- [ ] 測試 3D 模型載入效能（249k triangles）
- [ ] 修正動畫延遲與卡頓問題
- [ ] 部署至內網或可現場展示的環境
- [ ] 撰寫操作手冊（主持人使用）
- [ ] 準備備案方案（若 3D 載入失敗）

## 十、額外加分項目

- [ ] 記錄抽獎歷史與中獎名單
- [ ] 匯出中獎名單（CSV / Excel）
- [ ] UI 美化（醫院品牌色 / 春酒主題）
- [ ] 加入倒數計時動畫
- [ ] 支援多語言（中文 / 英文）
- [ ] 加入管理後台（設定參與者名單）
- [ ] 統計報表（中獎分布 / 部門統計）

---

## 下一步建議

1. **立即執行**：分析扭蛋機模型結構，找出可動部件
2. **核心功能**：完成把手旋轉 + 扭蛋掉落動畫
3. **基礎 UI**：開始抽獎按鈕 + 中獎者顯示
4. **整合測試**：完整流程測試（點擊 → 動畫 → 顯示結果）
